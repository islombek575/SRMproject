{% extends "base.html" %}
{% load widget_tweaks %}
{% block content %}
    <div class="container mx-auto py-8">
        <h2 class="text-3xl font-bold mb-6">{{ form_title }}</h2>
        <div class="bg-white shadow-lg rounded-xl p-6 max-w-lg mx-auto">
            <form method="POST">
                {% csrf_token %}
                <div id="top-messages" class="fixed top-5 right-5 z-50 space-y-2" style="min-width:260px"></div>
                {% for field in form %}
                    <div class="mb-4">
                        <label for="{{ field.id_for_label }}" class="block mb-1 font-medium">{{ field.label }}</label>

                        {% if field.name == "is_staff" %}
                            <div class="flex items-center space-x-2">
                                {{ field|add_class:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500" }}
                                <span class="text-gray-700">{{ field.label }}</span>
                            </div>
                        {% elif field.name == "role" %}
                            {{ field|add_class:"w-full border-2 border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400 bg-white" }}
                        {% else %}
                            {{ field|add_class:"w-full border-2 border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400" }}
                        {% endif %}

                        {% if field.errors %}
                            <p class="text-red-600 text-sm mt-1">{{ field.errors|striptags }}</p>
                        {% endif %}
                    </div>
                {% endfor %}
                <button type="submit"
                        class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 rounded-lg mt-4">Save
                </button>
            </form>
        </div>
    </div>
    <script>
        function showTopMessage(text, type = 'info') {
            // type: success / error / warning / info
            const id = 'msg-' + Date.now();
            const container = $('#top-messages');
            let bg = 'bg-gray-700';
            if (type === 'success') bg = 'bg-green-600';
            if (type === 'error') bg = 'bg-red-600';
            if (type === 'warning') bg = 'bg-yellow-600';
            const el = $(`<div id="${id}" class="px-4 py-3 rounded-lg text-white ${bg} shadow-md">${text}</div>`);
            container.append(el);
            setTimeout(() => {
                el.fadeOut(300, () => el.remove());
            }, 4000);
        }
    </script>

{% endblock %}
